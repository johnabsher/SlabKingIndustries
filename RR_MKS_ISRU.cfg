// Converters
@PART[MKS_Processor*]:NEEDS[MKS]:BEFORE[RationalResources]
{
	+MODULE[USI_ConverterSwapOption],0
	{
		@name = ModuleResourceConverter
	}
}
@PART[MKS_Processor125]:NEEDS[MKS]:AFTER[RationalResources]
{
	RRConverter = Set
	RRPower = .004 // serial ISRU capacity
}
@PART[MKS_Processor250]:NEEDS[MKS]:AFTER[RationalResources]
{
	@RRConverter = Set
	@RRPower = .02 // serial ISRU capacity
}
@PART[MKS_Processor375]:NEEDS[MKS]:AFTER[RationalResources]
{
	RRConverter = Set
	RRPower = .04 // serial ISRU capacity
}
@PART[MKS_Processor*]:NEEDS[MKS]:AFTER[RationalResourcesCompanion]
{
	@MODULE[ModuleResourceConverter]:HAS[#Tag[RR]]
	{
		@name = USI_ConverterSwapOption
	}
	-MODULE[systemEfficiency] {}
}

// Drills
@PART[MKS_Drill*,ATLAS_Harvester*]:NEEDS[MKS]:BEFORE[RationalResources]
{
	+MODULE[USI_HarvesterSwapOption],0
	{
		@name = ModuleResourceHarvester
	}
}
@PART[MKS_Drill*,ATLAS_Harvester*]:NEEDS[MKS]:AFTER[RationalResources]
{
	RRHarvester = Set
	RRSlots = 1
}
@PART[MKS_Drill*,ATLAS_Harvester*]:NEEDS[MKS]:AFTER[RationalResourcesCompanion]
{
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Dirt]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Gypsum]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Minerals]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Substrate]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[MetallicOre]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[MetalOre]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Water]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Hydrates]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Uraninite]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[RareMetals]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[ExoticMinerals]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Silicates]] {}
	!MODULE[ModuleResourceHarvester]:HAS[#ResourceName[Rock]] {}
	
	@MODULE[ModuleResourceHarvester]
	{
		@name = USI_HarvesterSwapOption
	}
}

// Purge MetalOre

!RESOURCE_DEFINITION[MetalOre]:NEEDS[RationalResources]:FINAL {}
!B9_TANK_TYPE:HAS[@RESOURCE[MetalOre]]:FINAL {}
@PART:HAS[@MODULE[ModuleB9PartSwitch]:HAS[@SUBTYPE[MetalOre]]]:FINAL
{
	@MODULE[ModuleB9PartSwitch]
	{
		!SUBTYPE[MetalOre] {}
	}
}

//ModuleResourceConverter, ModuleSystemHeatConverter, USI_ConverterSwapOption
@PART:HAS[@MODULE[ModuleResourceConverter]]:NEEDS[RationalResourcesCompanion]:FINAL
{
	!MODULE[*Converter*]:HAS[@INPUT_RESOURCE:HAS[#ResourceName[MetalOre]]] {}
}
@PART:HAS[@MODULE[ModuleSystemHeatConverter]]:NEEDS[RationalResourcesCompanion,SystemHeatConverters]:FINAL
{
	!MODULE[*Converter*]:HAS[@INPUT_RESOURCE:HAS[#ResourceName[MetalOre]]] {}
}
@PART:HAS[@MODULE[USI_ConverterSwapOption]:NEEDS[RationalResourcesCompanion,MKS]]:FINAL
{
	!MODULE[*Converter*]:HAS[@INPUT_RESOURCE:HAS[#ResourceName[MetalOre]]] {}
}
// ModuleResourceHarvester, ModuleSystemHeatHarvester, USI_HarvesterSwapOption
@PART:HAS[@MODULE[ModuleResourceHarvester]]:NEEDS[RationalResourcesCompanion]:FINAL
{
	!MODULE[*Harvester*]:HAS[#ResourceName[MetalOre]] {}
}
@PART:HAS[@MODULE[ModuleSystemHeatHarvester]]:NEEDS[RationalResourcesCompanion,SystemHeatConverters]:FINAL
{
	!MODULE[*Harvester*]:HAS[#ResourceName[MetalOre]] {}
}
@PART:HAS[@MODULE[USI_HarvesterSwapOption]:NEEDS[RationalResourcesCompanion,MKS]]:FINAL
{
	!MODULE[*Harvester*]:HAS[#ResourceName[MetalOre]] {}
}